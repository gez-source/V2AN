<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Atomic Prototype</title>

    <link href="web/styles/kendo.common.min.css" rel="stylesheet" />
    <link href="web/styles/kendo.default.min.css" rel="stylesheet" />
    <script src="web/js/jquery-1.12.3.min.js"></script>
    <script src="web/js/kendo.all.min.js"></script>
  </head>
  <body>

    <div id="textBox">
        <div class="inputPanel">
          <p>ATOMIC</p>
            <input type="text" placeholder="Search.." id="txtSearchByAddress">
            <button id="btnSearch">Search</button>
        </div>
    </div>

    <div id="ordersGrid"></div>

    <style>
        .inputPanel {padding: 50px; margin: 0 auto; text-align: center;}

    </style>

    <script>

      $(function() {

        $("#btnSearch").click(function(){
            $("#ordersGrid").data("kendoGrid").dataSource.read();
        });

        gridDataSource = new kendo.data.DataSource({
          //data: orderData,
          transport: {
            read: function(options) {

                $.ajax({
                    url: "http://localhost:8090/GetTransactions?addr=" + $("#txtSearchByAddress").val(),
                    dataType: "json", // "jsonp" is required for cross-domain requests; use "json" for same-domain requests
                    success: function(result) {

                    options.success(result);
                    },
                    error: function(result) {
                    // notify the data source that the request failed
                    options.error(result);
                    }
                });
            }
          },
          schema: {
              model: {
                  fields: {
                    TransactionHash: { type: "number" },
                    BlockID: { type: "date" },
                    Age: { type: "number" },
                    FromAddress: { type: "string" },
                    ToAddress: { type: "string" },
                    KeyValue: {type: "number"}
                  }
              }
          },
          pageSize: 20,
          sort: {
            field: "BlockID",
            dir: "desc"
          }
        });

        $("#ordersGrid").kendoGrid({
          dataSource: gridDataSource,
          theme: ["[Silver]"],
          //pageable: true,
          refresh: true,
          //sortable: true,
          //    filterable: true,
          columns: [{
            field:"TransactionHash",
            title: "Transaction Hash",
            width: 160
          }, {
            field: "Age",
            width: 160,
            template: "<span style='color:#= getAgeColor(Age) #'>#= Age #</span>"
          }, {
            field: "BlockID",
            title: "ID",
            width: 200,
            //format: "{0:dd MMMM yyyy}"
          }, {
            field: "FromAddress",
            title: "From Address"
          }, {
            field: "ToAddress",
            title: "To Address"
          }]
        });

      });

      function getAgeColor(Age) {
        if (Age > 60) {
          return "#090";
        } else if (Age < 30) {
          return "#f00";
        } else {
          return "#00c";
        }

      }

    </script>